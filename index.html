<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>コースタイマー</title>

<style>
body{
  font-family:sans-serif;
  text-align:center;
  background:#ffffff;
}

h2{
  margin-top:10px;
}

/* ===== 時間表示 ===== */
#time{
  font-size:52px;
  margin:20px 0;
}

/* ===== 電卓レイアウト ===== */
.pad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
  max-width:320px;
  margin:0 auto;
}

/* ===== ボタン共通 ===== */
button{
  padding:18px 0;
  font-size:18px;
  border:none;
  border-radius:18px;
  cursor:pointer;
  background:#ffe6f0;
  box-shadow:0 4px 0 #e0b3c2;
}

button:active{
  transform:translateY(2px);
  box-shadow:0 2px 0 #e0b3c2;
}

/* 延長ボタン */
.add{
  background:#d9f2ff;
  box-shadow:0 4px 0 #a3d8f0;
}

/* リセット */
.reset{
  background:#ffd6d6;
  box-shadow:0 4px 0 #f0a3a3;
  grid-column:span 3;
}
</style>
</head>

<body>

<h2>コースタイマー</h2>

<div id="time">00:00</div>

<div class="pad">
<button onclick="start(90)">90</button>
<button onclick="start(120)">120</button>
<button onclick="start(150)">150</button>

<button onclick="start(180)">180</button>
<button onclick="start(240)">240</button>
<button onclick="start(11)">11</button>

<button class="add" onclick="add(30)">+30</button>
<button class="add" onclick="add(60)">+60</button>

<button class="reset" onclick="reset()">リセット</button>
</div>

<script>
let sec=0;
let timer=null;
let blink=null;
let tenMinDone=false;

/* ===== 開始 ===== */
function start(min){
  clearInterval(timer);
  stopBlink();
  sec=min*60;
  tenMinDone=false;
  timer=setInterval(tick,1000);
  draw();
}

/* ===== カウント ===== */
function tick(){
  if(sec<=0){
    clearInterval(timer);
    endAlert();
    return;
  }

  sec--;

  if(sec==600 && !tenMinDone){
    tenMinDone=true;
    blinkStart("#b3ecff","#ffffff",800,30000);
  }

  draw();
}

/* ===== 表示 ===== */
function draw(){
  let m=Math.floor(sec/60);
  let s=sec%60;
  document.getElementById("time").innerText=
    String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
}

/* ===== 延長 ===== */
function add(m){
  sec+=m*60;
  tenMinDone=false;
}

/* ===== 終了 ===== */
function endAlert(){
  blinkStart("#ff4d4d","#ffffff",400,30000);
  document.getElementById("time").style.fontSize="64px";
}

/* ===== 点滅 ===== */
function blinkStart(c1,c2,speed,duration){
  stopBlink();
  let t=false;

  blink=setInterval(()=>{
    document.body.style.background=t?c1:c2;
    t=!t;
  },speed);

  setTimeout(stopBlink,duration);
}

function stopBlink(){
  if(blink){
    clearInterval(blink);
    blink=null;
  }
  document.body.style.background="#ffffff";
}

/* ===== リセット ===== */
function reset(){
  clearInterval(timer);
  stopBlink();
  sec=0;
  draw();
}
</script>

</body>
</html>
